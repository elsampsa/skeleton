<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial - start here ! &mdash; Skeleton  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="About this module" href="intro.html" />
    <link rel="prev" title="Skeleton" href="index.html" />
    <!-- as per https://stackoverflow.com/questions/23211695/modifying-content-width-of-the-sphinx-theme-read-the-docs -->
    <link href="_static/rtd_override.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  <a href="index.html"><img src="_static/skull.png" class="logo" alt="Logo"/>
</a>
    <div class="version">
      1.0.0
    </div>


<!-- font awesome comes with the rtd package.. use like this:-->
<a href="https://github.com/elsampsa/skeleton" class="icon icon-github"> Skeleton @ github</a>
<a href="https://github.com/elsampsa/skeleton/issues" class="fa fa-bug"> Issue Tracker @ github</a>

<!-- don't even think about subclassing searchbox.html .. will never work!-->
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial - start here !</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-s-in-it">What’s in it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-your-own-package">Creating Your Own Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#files">Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#online-autodocumentation">Online autodocumentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#organize-with-namespaces">Organize with namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-organization">Code Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packaging">Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#package-testing">Package testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pypi">PyPi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debian-packaging">Debian packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uploading-to-an-ubuntu-ppa">Uploading to an Ubuntu PPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-snippets">Example snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notebooks">Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="#internal-links">Internal links</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">About this module</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="submodules.html">Submodule documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Licenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Skeleton</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Tutorial - start here !</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="about"></span><div class="section" id="tutorial-start-here">
<h1>Tutorial - start here !<a class="headerlink" href="#tutorial-start-here" title="Permalink to this headline">¶</a></h1>
<p>Well, this module does actually nothing.</p>
<p>It’s a skeleton module that servers as a template for python3 projects:</p>
<a class="reference internal image-reference" href="_images/skull.png"><img alt="_images/skull.png" src="_images/skull.png" style="width: 10%;" /></a>
<p>Some features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Autogenerated documentation</p></li>
<li><p>Python packaging</p></li>
<li><p>Self-contained docker-compose scheme within the package (optional)</p></li>
<li><p>Creating a debian package of your software (very optional)</p></li>
<li><p>Development and production downloads from git</p></li>
<li><p>Uploading your package to PyPi</p></li>
<li><p>A C++ extension with SWIG : pass numpy arrays to &amp; fro between python and C++ (optional)</p></li>
<li><p>Live/hot-reload software development using notebooks</p></li>
<li><p>Proper code organization</p></li>
<li><p>Proper logging (never optional!)</p></li>
</ul>
</div></blockquote>
<div class="section" id="what-s-in-it">
<span id="impatient"></span><h2>What’s in it?<a class="headerlink" href="#what-s-in-it" title="Permalink to this headline">¶</a></h2>
<p>Let’s take a closer look at the directory structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>skeleton/               # python package dir
    setup.py            # standard python install script
    bash/               # helper scripts
    sudo/               # scripts for hard dependencies: sudo apt-get etc.
    build/              # python package build
    debian/             # debian package of your python package (optional)
    docker/             # Files for dockerization (optional) (see below)
    docs/               # this documentation
    licenses/           # your favorite FOSS licenses - pick one
    notebook/           # interactive code development with notebooks
    skeleton/           # python source code directory
        data/           # package&#39;s static data
        ini/            # a default/example ini config file --&gt; for microservices, the final one should live in secrets (**)
        greeters/       # demo
        qt/             # if you&#39;re into PyQt/PySide2 (optional)
        skeleton_cpp/   # interfaced cpp code as this python package&#39;s submodule OR as a separate python package
</pre></div>
</div>
<p>As you can see, there’s a lot here.  Some more details:</p>
<ul class="simple">
<li><p>You can also run your package as a microservice using a <code class="docutils literal notranslate"><span class="pre">docker-compose-dev.yml</span></code> file (see below)</p></li>
<li><p>The package includes a C++ submodule with C++ code interfaced to python and that is compiled on-the-fly once you install the python package (see below)</p></li>
<li><p>Directory <code class="docutils literal notranslate"><span class="pre">notebook/</span></code> shows you how to use notebooks for interactive code developments.  There you can also test calls to the C++ part.</p></li>
</ul>
<p>If you wish to create a docker(-compose) scaffold, just type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash/dockerize.bash
</pre></div>
</div>
<p id="docker-scheme">After that, your directory structure has been modified into this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>skeleton/
    dev.bash                # softlinked to --&gt; (A)
    docker-compose-dev.yml  # softlinked to --&gt; (B)
    secrets/                # password, etc. secrets for microservice deployment
        dev.ini             # copied from (C)
    datashare/              # directory for data sharing with docker run

    skeleton/               # THE ORIGINAL PYTHON PACKAGE DIRECTORY (see above)
        bash/               # helper scripts
            dev.bash        # (A) helper that runs docker-compose (copies (C) always into secrets/dev.ini)
        docker/             # Dockerfile(s) (optional) of this microservice
            docker-compose-dev.yml
                            # (B) docker-compose file for dockerization/microservice
        skeleton/           # python source code directory
            ini/
                default.ini # (C) default .ini file
</pre></div>
</div>
<p>i.e. series of extra directories and softlinks are created, while the python package directory stays unmodified.</p>
<p>It is recommended to run the <code class="docutils literal notranslate"><span class="pre">dockerize.bash</span></code> script after you have done the “Creating Your Own Package” chapter (see below).</p>
<p>Why do it this way?  We want a self-contained python package with dockerization information in it.  On the other hand,
we don’t want our package/repo to be a docker-compose “wireframe”.  Let’s emphasize that: <em>the only thing we upload to git is the python package directory</em>.</p>
<p>Once you have created that directory structure &amp; links, its great starting point for developing your python package into a microservice.
Of course, for your final service including (maybe) various microservices, you would create a separate repo having only <code class="docutils literal notranslate"><span class="pre">docker-compose-dev.yml</span></code>
(and little more) and use the following scheme:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>docker-compose-dev.yml # consider using docker-compose &quot;include&quot; clause from directories microservice-1/docker/ etc.
datashare/
secrets/
microservice-1/     # as git submodule
microservice-2/     # as git submodule
microservice-3/     # as git submodule
...
</pre></div>
</div>
<p>For more info about git submodules, please see <a class="reference external" href="https://gist.github.com/gitaarik/8735255">this</a>.</p>
</div>
<div class="section" id="creating-your-own-package">
<h2>Creating Your Own Package<a class="headerlink" href="#creating-your-own-package" title="Permalink to this headline">¶</a></h2>
<p>Let’s suppose your name is <em>Janne Jantunen</em> and you have decided to create a new package named <em>your_package_name</em>.  Proceed like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/elsampsa/skeleton
mv skeleton your_package_name
<span class="nb">cd</span> your_package_name <span class="c1"># the self-contained python package dir</span>
bash/reinit.bash
bash/cleanpy.bash
bash/setauthor.bash <span class="s2">&quot;Janne Jantunen&quot;</span>
bash/setver.bash <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
</pre></div>
</div>
<p>That should change all occurrences of “skeleton” (in the file and directory names and inside the files)
into “your_package_name”, among other things.</p>
<p>If you don’t wan’t the cpp extensions, edit <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> &amp; comment the cpp section away.</p>
<p>If you want to use the provided dockerization scheme (see above), run next:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash/dockerize.bash
<span class="nb">cd</span> your_package_name
</pre></div>
</div>
<p>Which will create series of directories and softlinks</p>
<p>Finally, run this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> your_package_name
pip3 install --user -e .
</pre></div>
</div>
<p>This way your package is installed in the “editable mode” (that extra “-e”).  It creates link from the python package directory (in linux, look for <code class="docutils literal notranslate"><span class="pre">$HOME/.local/lib/python3.x/site-packages/*.egg-link</span></code> files)
to your local directory.  Now python’s package system can find your module.</p>
<p>If you did not use the <code class="docutils literal notranslate"><span class="pre">-e</span></code> switch, it would simply create a copy of your code and place it into the python package directory and your future changes to the codebase would not
be updated.</p>
<p>Now you can try these commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>skeleton -h
skeleton-service -h
</pre></div>
</div>
<p>They map to <code class="docutils literal notranslate"><span class="pre">skeleton/skeleton/cli.py</span></code> and <code class="docutils literal notranslate"><span class="pre">service.py</span></code> (look into <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> how this mapping is done).</p>
<p>One is a desktop-like end-point that caches configurations under user’s home dir, while the other one is a microservice-like end-point that
uses an <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file for configuration and sensitive information.</p>
<p>You can mod the documentation by editing <code class="docutils literal notranslate"><span class="pre">.rst</span></code> files in the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> directory.  The idea is that you hide/delete this page (<code class="docutils literal notranslate"><span class="pre">tutorial.rst</span></code>) from your own module.</p>
<p>After installing the package, you can re-compile and check the documentation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> docs
./compile.bash
<span class="nb">cd</span> ..
firefox docs/index.html
</pre></div>
</div>
<p>If you want to push your newly minted python project into a git repo, do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git init
git remote add origin https://<span class="o">[</span>your-personal-git-repository<span class="o">]</span>/your_package_name.git
git add *
git commit -m <span class="s2">&quot;initial commit&quot;</span>
git push -u origin master
</pre></div>
</div>
<p>NOTE: be sure just to do this to the python package directory and not for the whole dockerization directory scheme if you use that.</p>
<p>Please note the file <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> for the files we do <em>not</em> want into our package.</p>
<p>The name of your package (that is also the name of your python module) should not contain “weird characters”, i.e. “.,-” etc.</p>
<p>Git tags can be added with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git tag v1.2 -m <span class="s2">&quot;cool version v1.2&quot;</span>
git push origin --tags
</pre></div>
</div>
<p>However, it’s recommended to use the <code class="docutils literal notranslate"><span class="pre">bash/git_tag.bash</span></code> script together with the <code class="docutils literal notranslate"><span class="pre">bash/setver.bash</span></code> script</p>
<p>Now production users can install with pip3 certain revisions of the software (see <a class="reference internal" href="requirements.html#production"><span class="std std-ref">here</span></a>)</p>
</div>
<div class="section" id="docker">
<h2>Docker<a class="headerlink" href="#docker" title="Permalink to this headline">¶</a></h2>
<p>If you ran the dockerization script, your directory structure should look like explained in <a class="reference internal" href="#docker-scheme"><span class="std std-ref">here</span></a>.
In order to build the docker image and create a running container, simply run in the main directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dev.bash build
dev.bash up
</pre></div>
</div>
<p>The C++ extension is put on the docker image,
while all other code is read from local directory via a shared docker mount.</p>
<p>The docker container sees this directory structure (see <code class="docutils literal notranslate"><span class="pre">Dockerfile.dev</span></code> and <code class="docutils literal notranslate"><span class="pre">docker-compose-dev.yml</span></code> for more details):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/usr/src/app/          # directory on the docker image

    requirements.txt   # files copied from the python package directory
    MANIFEST.in        # into the docker image
    setup.py           #

    skeleton/          # python SOURCE CODE DIRECTORY as a shared docker mount
                       # NOTE: NOT the python package directory (see above)
                       # docker shall not write __pycache__ directories here
                       # (see &quot;PYTHONPYCACHEPREFIX&quot; in Dockerfile.dev)
        ...            #
        docker/        # docker entry-point scripts
        ...            #
</pre></div>
</div>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>Keep them up-to-date in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code></p>
</div>
<div class="section" id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<p>This page has been produced with the file <code class="docutils literal notranslate"><span class="pre">skeleton/docs/tutorial.rst</span></code>.  Go ahead and open it in your editor.  Open also “index.rst”.  Edit them accordingly.
Said that, let’s take a closer look at the directory structure (in the following <code class="docutils literal notranslate"><span class="pre">skeleton</span></code> is synonymous to <code class="docutils literal notranslate"><span class="pre">your_package_name</span></code>):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">skeleton/</span></code> : This is the python package directory</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>README.md</p></td>
<td><p>Readme file in online markdown format (nice for github). Play around with online markdown <a class="reference external" href="https://stackedit.io/editor">here</a></p></td>
</tr>
<tr class="row-even"><td><p>licenses/</p></td>
<td><p>Pick up a FOSS license and copy it here as “COPYING”</p></td>
</tr>
<tr class="row-odd"><td><p>CHANGELOG</p></td>
<td><p>Recent changes in the code</p></td>
</tr>
<tr class="row-even"><td><p>setup.py</p></td>
<td><p>Python setup script for creating packages</p></td>
</tr>
<tr class="row-odd"><td><p>MANIFEST.in</p></td>
<td><p>Used by setup.py</p></td>
</tr>
<tr class="row-even"><td><p>.gitignore</p></td>
<td><p>Files ignored by git</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">skeleton/sudo</span></code> : System-specific install scripts</p>
<p>Sometimes you just need to use that <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">install</span></code> for some base packages &amp; other libraries your program package needs.
It’s a good practice to collect all those extra super-user commands into a separate script.  The <code class="docutils literal notranslate"><span class="pre">ubuntu.bash</span></code> in the bootstrap/ directory
for example, installs build environment &amp; swig that you need to install the cpp extensions.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bash/</span></code> : Some helper scripts</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>dockerize.bash</p></td>
<td><p>Creates a docker-compose “wireframe” directory structure around your python package</p></td>
</tr>
<tr class="row-even"><td><p>add_untracked.bash</p></td>
<td><p>Add all new files to git</p></td>
</tr>
<tr class="row-odd"><td><p>changestr.bash</p></td>
<td><p>Helper script to change strings in your package</p></td>
</tr>
<tr class="row-even"><td><p>reinit.bash</p></td>
<td><p>Reinitializes the package name (you used this in the very beginning)</p></td>
</tr>
<tr class="row-odd"><td><p>cleanpy.bash</p></td>
<td><p>Removes __pycache__ directories and .pyc files; Do maybe before “git add .”</p></td>
</tr>
<tr class="row-even"><td><p>dev.bash</p></td>
<td><p>Docker-compose short-hand command</p></td>
</tr>
<tr class="row-odd"><td><p>make_venv.bash</p></td>
<td><p>Create python virtualenv short-hand command</p></td>
</tr>
<tr class="row-even"><td><p>upload.bash</p></td>
<td><p>Uploads your python package into PyPi</p></td>
</tr>
<tr class="row-odd"><td><p>test_upload.bash</p></td>
<td><p>Uploads your python package into PyPi test repository</p></td>
</tr>
<tr class="row-even"><td><p>setver.bash</p></td>
<td><p>Helper script to change the version of your package</p></td>
</tr>
<tr class="row-odd"><td><p>setauthor.bash</p></td>
<td><p>Helper script to change the author of the package</p></td>
</tr>
<tr class="row-even"><td><p>git_tag.bash</p></td>
<td><p>Pushes version information into git.  This script is modified by the setver.bash</p></td>
</tr>
<tr class="row-odd"><td><p>git_rm_tag.bash</p></td>
<td><p>Removes the version information (if you made an error)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">skeleton/docs/</span></code>  : Documentation and autogenerated documentation lives here</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>index.html</p></td>
<td><p>Redirects to the autogenerated html [don’t touch]</p></td>
</tr>
<tr class="row-even"><td><p>index.rst</p></td>
<td><p>The main index start from here</p></td>
</tr>
<tr class="row-odd"><td><p>tutorial.rst</p></td>
<td><p>The file you are staring at the moment (or html version of it)</p></td>
</tr>
<tr class="row-even"><td><p>intro.rst</p></td>
<td><p>Introduction of the module</p></td>
</tr>
<tr class="row-odd"><td><p>requirements.rst</p></td>
<td><p>What the user needs in order to use this module</p></td>
</tr>
<tr class="row-even"><td><p>examples.rst</p></td>
<td><p>Copy-pastable examples for the api user</p></td>
</tr>
<tr class="row-odd"><td><p>submodules.rst</p></td>
<td><p>Documentation generated automatically from source code.  Just add a new entry here for each submodule, don’t touch otherwise</p></td>
</tr>
<tr class="row-even"><td><p>license.rst</p></td>
<td><p>Copyright and License</p></td>
</tr>
<tr class="row-odd"><td><p>authors.rst</p></td>
<td><p>Who is the maintainer &amp; author</p></td>
</tr>
<tr class="row-even"><td><p>compile.bash</p></td>
<td><p>Run this always after modifying your documents / source code [don’t edit]</p></td>
</tr>
<tr class="row-odd"><td><p>clean.bash</p></td>
<td><p>Clean autogenerated documentation [don’t edit]</p></td>
</tr>
<tr class="row-even"><td><p>conf.py</p></td>
<td><p>Sphinx configuration file.  <strong>edit this and try different styles</strong></p></td>
</tr>
<tr class="row-odd"><td><p>.nojekyll</p></td>
<td><p>Dummy file.  This is needed for the on-line documentation to work with GitHub [don’t touch]</p></td>
</tr>
<tr class="row-even"><td><p>snippets/</p></td>
<td><p>Example snippet source files and scripts for generating pages from them.  Edit also the file requirements.txt here.</p></td>
</tr>
<tr class="row-odd"><td><p>generated/</p></td>
<td><p>Auto-generated documents [don’t touch]</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">skeleton/skeleton</span></code> : Python source code directory</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__init__.py</p></td>
<td><p>Python module initialization</p></td>
</tr>
<tr class="row-even"><td><p>greeters/</p></td>
<td><p>Submodule</p></td>
</tr>
<tr class="row-odd"><td><p>data/</p></td>
<td><p>Static data the module needs and that is included in the python package</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">skeleton/skeleton_cpp/</span></code> : A numpy C++ extension module that uses SWIG</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>README.md</p></td>
<td><p>read this first</p></td>
</tr>
<tr class="row-even"><td><p>compile.bash</p></td>
<td><p>stand-alone compilation command.  Remember that when you run <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span></code>, it also compiles the package</p></td>
</tr>
<tr class="row-odd"><td><p>runswig.bash</p></td>
<td><p>stand-alone swig command.</p></td>
</tr>
<tr class="row-even"><td><p>skeleton_cpp_module.cpp</p></td>
<td><p>cpp example</p></td>
</tr>
<tr class="row-odd"><td><p>skeleton_cpp_module.h</p></td>
<td><p>dummy cpp example</p></td>
</tr>
<tr class="row-even"><td><p>skeleton_cpp_module.i</p></td>
<td><p>an example interface file</p></td>
</tr>
<tr class="row-odd"><td><p>skeleton_cpp_module.py</p></td>
<td><p>generated by swig</p></td>
</tr>
<tr class="row-even"><td><p>skeleton_cpp_module_wrap.cpp</p></td>
<td><p>generated by swig</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>It’s time to start documenting!  Edit the files <code class="docutils literal notranslate"><span class="pre">docs/*.rst</span></code>.  Here are <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">some nice tips</a>
for using Sphinx and here <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/inline.html">are some more</a></p>
<p>To create and to recreate the docs (after changing the code, etc.), do (in the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> directory):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./compile.bash
</pre></div>
</div>
<p>To see your documentation, launch</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>firefox index.html
</pre></div>
</div>
</div>
<div class="section" id="online-autodocumentation">
<h2>Online autodocumentation<a class="headerlink" href="#online-autodocumentation" title="Permalink to this headline">¶</a></h2>
<p><strong>Github users</strong></p>
<p>After creating the git repo, create also a site for your project like this:  Settings =&gt; GitHub pages =&gt; Source : master branch / docs folder =&gt; press Save.  Now your documentation is online in github! (don’t forget to include the “docs/” folder into git).</p>
<p><strong>Gitlab users</strong></p>
<p>Using a generic service that uses a gitlab server?  No problem.  There is a simple hack to put the autodocs online.</p>
<blockquote>
<div><ul class="simple">
<li><p>In gitlab, create a wiki page for your project.  Write there the words “Hello world”.  Next, clone the wiki repository (not <em>the</em> repository, just the <em>wiki repository</em>) with that button on the right that says “clone repository”.</p></li>
<li><p>Edit your projects “docs/compile.bash”.  Uncomment the options for Gitlab and set the directory of your wiki repository correctly.  Run “./compile.bash”.  Now the whole documentation tree has been copied to your wiki repo directory.</p></li>
<li><p>In the wiki repo directory, open “home.md” in an editor.  Modify it to look like this:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>For documentation
[click here](_build/html/index.html)
</pre></div>
</div>
<ul class="simple">
<li><p>You still need to use git to add and push all the files to the wiki repository online (there are instructions in “compile.bash”)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="organize-with-namespaces">
<h2>Organize with namespaces<a class="headerlink" href="#organize-with-namespaces" title="Permalink to this headline">¶</a></h2>
<p>You can also organize your module under namespaces.  Read more about it <a class="reference external" href="https://packaging.python.org/guides/packaging-namespace-packages/">here</a>.</p>
<p>Let’s assume two modules</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>namespace_subpackage1/
    setup.py            Remember that automatic package finder does not work for namespace packages
    etc.
    namespace/          Keep this directory empty
        subpackage1/
            __init__.py
            submodule1
            submodule2
</pre></div>
</div>
<p>The other one being</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>namespace_subpackage2/
    setup.py            Remember that automatic package finder does not work for namespace packages
    etc.
    namespace/          Keep this directory empty
        subpackage2/
            __init__.py
            submodule1
            submodule2
</pre></div>
</div>
<p>Once installed, the following works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">namespace.subpackage1</span> <span class="kn">import</span> <span class="n">something</span>
<span class="kn">from</span> <span class="nn">namespace.subpackage2</span> <span class="kn">import</span> <span class="n">something_else</span>
</pre></div>
</div>
</div>
<div class="section" id="code-organization">
<h2>Code Organization<a class="headerlink" href="#code-organization" title="Permalink to this headline">¶</a></h2>
<p>This tutorial comes with a module that has a single submodule called “greeters” that is organized as follows:</p>
<dl>
<dt>greeters</dt><dd><div class="line-block">
<div class="line">__init__.py</div>
<div class="line">base.py</div>
<div class="line">fancy.py</div>
</div>
</dd>
</dl>
<p>The idea is that <code class="docutils literal notranslate"><span class="pre">base.py</span></code> has some base class definitions that are used by <code class="docutils literal notranslate"><span class="pre">fancy.py</span></code> to create derived classes.
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> has been tweaked so that user can import with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">your_package_name.greeters</span> <span class="kn">import</span> <span class="n">FancyHelloWorld</span>
</pre></div>
</div>
<p>instead of the cumbersome</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">your_package_name.fancy.greeters</span> <span class="kn">import</span> <span class="n">FancyHelloWorld</span>
</pre></div>
</div>
<p>In general, use <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> only for exposing your API.  Do not write any classes or
methods therein.</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">cli.py</span></code> is the command-line entry point for the whole application.  See in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> how
you can map a command into <code class="docutils literal notranslate"><span class="pre">cli.py</span></code>.</p>
</div>
<div class="section" id="packaging">
<h2>Packaging<a class="headerlink" href="#packaging" title="Permalink to this headline">¶</a></h2>
<p>If you have done everything as instructed here, creating a distributable python package can be done as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> your_package_name
python3 setup.py sdist
</pre></div>
</div>
<p>Your distributable python package is now in directory “dist/”.  You can install it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --upgrade dist/your_package_name-version.tar.gz
</pre></div>
</div>
<p>The setup.py script automatically finds and includes python packages to the distribution package.  In “MANIFEST.in” we also tell it to include the complete “docs/” directory and an auxiliary file from the “greeters” submodule.  See “setup.py” for more instructions.</p>
<p>Polish your setup script with the following cycle:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm dist/*
python3 setup.py sdist
pip3 install --user --upgrade --verbose dist/your_package_name-version.tar.gz
</pre></div>
</div>
<p>The verbose option is nice to see any problems, with say, your post-installing script defined in setup.py.  Once you have got rid of all the errors, you can be sure that it works also when people install your python package directly from git using pip3.</p>
</div>
<div class="section" id="package-testing">
<h2>Package testing<a class="headerlink" href="#package-testing" title="Permalink to this headline">¶</a></h2>
<p>When testing the pip3 installation, use virtualenv to see that you got the dependencies right.  First, create a virtualenv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>virtualenv --no-site-packages -p python3 <span class="nb">test</span>
</pre></div>
</div>
<p>Then let’s use that virtualenv (we also clean up PYTHONPATH) to test your production system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nb">test</span>
<span class="nb">source</span> bin/activate
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>
pip3 install --user --upgrade git+git://<span class="o">[</span>your-personal-git-repository<span class="o">]</span>/your_package_name
</pre></div>
</div>
<p>See <a class="reference internal" href="requirements.html#started"><span class="std std-ref">here</span></a> how the end-user would be using your python module directly from git.</p>
<p>To exit from virtualenv, use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>deactivate
</pre></div>
</div>
</div>
<div class="section" id="pypi">
<h2>PyPi<a class="headerlink" href="#pypi" title="Permalink to this headline">¶</a></h2>
<p>By uploading your python package to PyPi (Python Package Index), end users can install it simply with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --user packagename
</pre></div>
</div>
<p>To use the python package repositories, follow these steps:</p>
<ol class="arabic simple">
<li><p>Create an account in <a class="reference external" href="https://pypi.org">PyPi repository</a> and in <a class="reference external" href="https://testpypi.python.org">PyPi test repository</a></p></li>
<li><p>Create file <code class="docutils literal notranslate"><span class="pre">$HOME/.pypirc</span></code> with the following contents:</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[distutils]
index-servers =
    pypi
    test

[pypi]
username: xxx
password: xxx

[test]
repository: https://test.pypi.org/legacy/
username: xxx
password: xxx
</pre></div>
</div>
<p>The modern way to connect safely to pypi, is via a token.  Then the <code class="docutils literal notranslate"><span class="pre">pypi</span></code> section looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[pypi]
username = __token__
password = a_very_long_token
</pre></div>
</div>
<p>Get your token from pypi.org!</p>
<ol class="arabic simple" start="3">
<li><p>Install twine</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --user twine
</pre></div>
</div>
<p>Now you can use the scripts <em>test_upload.bash</em> and <em>upload.bash</em> to send your package to the python (test) repository (first, edit those scripts).</p>
<p>To install from test repository (instead of the official one), use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --user --extra-index-url https://testpypi.python.org/pypi packagename
</pre></div>
</div>
</div>
<div class="section" id="debian-packaging">
<h2>Debian packaging<a class="headerlink" href="#debian-packaging" title="Permalink to this headline">¶</a></h2>
<p>Create a .deb package like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make -f debian/rules package
</pre></div>
</div>
</div>
<div class="section" id="uploading-to-an-ubuntu-ppa">
<h2>Uploading to an Ubuntu PPA<a class="headerlink" href="#uploading-to-an-ubuntu-ppa" title="Permalink to this headline">¶</a></h2>
<p>Start like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>debuild -S -sa
</pre></div>
</div>
<p>Now in the upper level directory you will have the file <em>skeleton_0.0.0-0ubuntu1-bionicppa1_source.changes</em>.  You can send it to your Ubuntu PPA (personal package archive) with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dput ppa:your-name/your-repo skeleton_0.0.0-0ubuntu1-bionicppa1_source.changes
</pre></div>
</div>
</div>
<div class="section" id="example-snippets">
<h2>Example snippets<a class="headerlink" href="#example-snippets" title="Permalink to this headline">¶</a></h2>
<p>The following python code can be downloaded from <a class="reference download internal" download="" href="_downloads/86df3b757703bdb72f25c7a8471a46ba/example1.py"><code class="xref download docutils literal notranslate"><span class="pre">[here]</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skeleton.greeters</span> <span class="kn">import</span> <span class="n">FancyHelloWorld</span>
<span class="c1"># let&#39;s create an instance</span>
<span class="n">gr</span><span class="o">=</span><span class="n">FancyHelloWorld</span><span class="p">(</span><span class="n">person</span><span class="o">=</span><span class="s2">&quot;Sampsa&quot;</span><span class="p">)</span>
<span class="c1"># print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gr</span><span class="p">)</span>
</pre></div>
</div>
<p>Check out directory “docs/snippets/”.  It serves as a collection for small example programs.  Open and edit “form_snippets.bash” there.  You can then run it.  Remember to recompile the documentation once you’ve run that script.</p>
</div>
<div class="section" id="notebooks">
<h2>Notebooks<a class="headerlink" href="#notebooks" title="Permalink to this headline">¶</a></h2>
<p>Notebooks can used for interactive code development and testing!</p>
<p>Go to directory <code class="docutils literal notranslate"><span class="pre">notebook</span></code> and run there:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter notebook
</pre></div>
</div>
<p>Open the example notebook.
Observe how neatly you can do interactive code development with notebooks.
The example notebook also shows how to use the installed python package (including the cpp extensions)</p>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Check out in the source code, how I init and check a large number of parameters in the constructor</p></li>
<li><p>To keep your code clean and PEP8 compliant, there’s a nice tool called “autopep8”, install with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --user autopep8
</pre></div>
</div>
<p>Now you can fix a python file like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>autopep8 --aggressive --in-place yourfile.py
</pre></div>
</div>
</div>
<div class="section" id="internal-links">
<h2>Internal links<a class="headerlink" href="#internal-links" title="Permalink to this headline">¶</a></h2>
<p>Remember that reference we did up there?  Here is a <a class="reference internal" href="intro.html#intro"><span class="std std-ref">link</span></a> to it.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Skeleton" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="intro.html" class="btn btn-neutral float-right" title="About this module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2023 Sampsa Riikonen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>